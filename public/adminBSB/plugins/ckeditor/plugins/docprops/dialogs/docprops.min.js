CKEDITOR.dialog.add("docProps",function(s){function x(g,l){var k=function(){c(this);l(this,this._.parentDialog)},c=function(m){m.removeListener("ok",k);m.removeListener("cancel",c)},h=function(m){m.on("ok",k);m.on("cancel",c)};s.execCommand(g);if(s._.storedDialogs.colordialog){h(s._.storedDialogs.colordialog)}else{CKEDITOR.on("dialogDefinition",function(m){if(m.data.name==g){var n=m.data.definition;m.removeListener();n.onLoad=CKEDITOR.tools.override(n.onLoad,function(p){return function(){h(this);n.onLoad=p;"function"==typeof p&&p.call(this)}})}})}}function e(){var c=this.getDialog().getContentElement("general",this.id+"Other");c&&("other"==this.getValue()?(c.getInputElement().removeAttribute("readOnly"),c.focus(),c.getElement().removeClass("cke_disabled")):(c.getInputElement().setAttribute("readOnly",!0),c.getElement().addClass("cke_disabled")))}function j(c,h,g){return function(k,l,m){l=f;k="undefined"!=typeof g?g:this.getValue();!k&&c in l?l[c].remove():k&&c in l?l[c].setAttribute("content",k):k&&(l=new CKEDITOR.dom.element("meta",s.document),l.setAttribute(h?"http-equiv":"name",c),l.setAttribute("content",k),m.append(l))}}function i(c,g){return function(){var h=f,h=c in h?h[c].getAttribute("content")||"":"";if(g){return h}this.setValue(h);return null}}function d(c){return function(l,k,g,h){h.removeAttribute("margin"+c);l=this.getValue();""!==l?h.setStyle("margin-"+c,CKEDITOR.tools.cssLength(l)):h.removeStyle("margin-"+c)}}function b(c,h,g){c.removeStyle(h);c.getComputedStyle(h)!=g&&c.setStyle(h,g)}var v=s.lang.docprops,o=s.lang.common,f={},a=function(c,h,g){return{type:"hbox",padding:0,widths:["60%","40%"],children:[CKEDITOR.tools.extend({type:"text",id:c,label:v[h]},g||{},1),{type:"button",id:c+"Choose",label:v.chooseColor,className:"colorChooser",onClick:function(){var k=this;x("colordialog",function(m){var l=k.getDialog();l.getContentElement(l._.currentTabId,c).setValue(m.getContentElement("picker","selectedColor").getValue())})}}]}},w="javascript:void((function(){"+encodeURIComponent("document.open();"+(CKEDITOR.env.ie?"("+CKEDITOR.tools.fixDomain+")();":"")+'document.write( \'\x3chtml style\x3d"background-color: #ffffff; height: 100%"\x3e\x3chead\x3e\x3c/head\x3e\x3cbody style\x3d"width: 100%; height: 100%; margin: 0px"\x3e'+v.previewHtml+"\x3c/body\x3e\x3c/html\x3e' );document.close();")+"})())";return{title:v.title,minHeight:330,minWidth:500,onShow:function(){for(var y=s.document,r=y.getElementsByTag("html").getItem(0),q=y.getHead(),u=y.getBody(),p={},t=y.getElementsByTag("meta"),n=t.count(),m=0;m<n;m++){var g=t.getItem(m);p[g.getAttribute(g.hasAttribute("http-equiv")?"http-equiv":"name").toLowerCase()]=g}f=p;this.setupContent(y,r,q,u)},onHide:function(){f={}},onOk:function(){var g=s.document,k=g.getElementsByTag("html").getItem(0),h=g.getHead(),c=g.getBody();this.commitContent(g,k,h,c)},contents:[{id:"general",label:o.generalTab,elements:[{type:"text",id:"title",label:v.docTitle,setup:function(c){this.setValue(c.getElementsByTag("title").getItem(0).data("cke-title"))},commit:function(h,l,k,g,m){m||h.getElementsByTag("title").getItem(0).data("cke-title",this.getValue())}},{type:"hbox",children:[{type:"select",id:"dir",label:o.langDir,style:"width: 100%",items:[[o.notSet,""],[o.langDirLtr,"ltr"],[o.langDirRtl,"rtl"]],setup:function(g,k,h,c){this.setValue(c.getDirection()||"")},commit:function(g,k,h,c){(g=this.getValue())?c.setAttribute("dir",g):c.removeAttribute("dir");c.removeStyle("direction")}},{type:"text",id:"langCode",label:o.langCode,setup:function(c,g){this.setValue(g.getAttribute("xml:lang")||g.getAttribute("lang")||"")},commit:function(h,l,k,g,m){m||((h=this.getValue())?l.setAttributes({"xml:lang":h,lang:h}):l.removeAttributes({"xml:lang":1,lang:1}))}}]},{type:"hbox",children:[{type:"select",id:"charset",label:v.charset,style:"width: 100%",items:[[o.notSet,""],[v.charsetASCII,"us-ascii"],[v.charsetCE,"iso-8859-2"],[v.charsetCT,"big5"],[v.charsetCR,"iso-8859-5"],[v.charsetGR,"iso-8859-7"],[v.charsetJP,"iso-2022-jp"],[v.charsetKR,"iso-2022-kr"],[v.charsetTR,"iso-8859-9"],[v.charsetUN,"utf-8"],[v.charsetWE,"iso-8859-1"],[v.other,"other"]],"default":"",onChange:function(){this.getDialog().selectedCharset="other"!=this.getValue()?this.getValue():"";e.call(this)},setup:function(){this.metaCharset="charset" in f;var c=i(this.metaCharset?"charset":"content-type",1,1).call(this);!this.metaCharset&&c.match(/charset=[^=]+$/)&&(c=c.substring(c.indexOf("\x3d")+1));if(c){this.setValue(c.toLowerCase());if(!this.getValue()){this.setValue("other");var g=this.getDialog().getContentElement("general","charsetOther");g&&g.setValue(c)}this.getDialog().selectedCharset=c}e.call(this)},commit:function(h,l,k,g,m){m||(g=this.getValue(),m=this.getDialog().getContentElement("general","charsetOther"),"other"==g&&(g=m?m.getValue():""),g&&!this.metaCharset&&(g=(f["content-type"]?f["content-type"].getAttribute("content").split(";")[0]:"text/html")+"; charset\x3d"+g),j(this.metaCharset?"charset":"content-type",1,g).call(this,h,l,k))}},{type:"text",id:"charsetOther",label:v.charsetOther,onChange:function(){this.getDialog().selectedCharset=this.getValue()}}]},{type:"hbox",children:[{type:"select",id:"docType",label:v.docType,style:"width: 100%",items:[[o.notSet,""],["XHTML 1.1",'\x3c!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"\x3e'],["XHTML 1.0 Transitional",'\x3c!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"\x3e'],["XHTML 1.0 Strict",'\x3c!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"\x3e'],["XHTML 1.0 Frameset",'\x3c!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd"\x3e'],["HTML 5","\x3c!DOCTYPE html\x3e"],["HTML 4.01 Transitional",'\x3c!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"\x3e'],["HTML 4.01 Strict",'\x3c!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"\x3e'],["HTML 4.01 Frameset",'\x3c!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" "http://www.w3.org/TR/html4/frameset.dtd"\x3e'],["HTML 3.2",'\x3c!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"\x3e'],["HTML 2.0",'\x3c!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN"\x3e'],[v.other,"other"]],onChange:e,setup:function(){if(s.docType&&(this.setValue(s.docType),!this.getValue())){this.setValue("other");var c=this.getDialog().getContentElement("general","docTypeOther");c&&c.setValue(s.docType)}e.call(this)},commit:function(h,l,m,g,k){k||(h=this.getValue(),l=this.getDialog().getContentElement("general","docTypeOther"),s.docType="other"==h?l?l.getValue():"":h)}},{type:"text",id:"docTypeOther",label:v.docTypeOther}]},{type:"checkbox",id:"xhtmlDec",label:v.xhtmlDec,setup:function(){this.setValue(!!s.xmlDeclaration)},commit:function(h,l,m,g,k){k||(this.getValue()?(s.xmlDeclaration='\x3c?xml version\x3d"1.0" encoding\x3d"'+(this.getDialog().selectedCharset||"utf-8")+'"?\x3e',l.setAttribute("xmlns","http://www.w3.org/1999/xhtml")):(s.xmlDeclaration="",l.removeAttribute("xmlns")))}}]},{id:"design",label:v.design,elements:[{type:"hbox",widths:["60%","40%"],children:[{type:"vbox",children:[a("txtColor","txtColor",{setup:function(h,k,l,g){this.setValue(g.getComputedStyle("color"))},commit:function(h,l,m,g,k){if(this.isChanged()||k){g.removeAttribute("text"),(h=this.getValue())?g.setStyle("color",h):g.removeStyle("color")}}}),a("bgColor","bgColor",{setup:function(h,k,l,g){h=g.getComputedStyle("background-color")||"";this.setValue("transparent"==h?"":h)},commit:function(h,l,m,g,k){if(this.isChanged()||k){g.removeAttribute("bgcolor"),(h=this.getValue())?g.setStyle("background-color",h):b(g,"background-color","transparent")}}}),{type:"hbox",widths:["60%","40%"],padding:1,children:[{type:"text",id:"bgImage",label:v.bgImage,setup:function(h,k,l,g){h=g.getComputedStyle("background-image")||"";h="none"==h?"":h.replace(/url\(\s*(["']?)\s*([^\)]*)\s*\1\s*\)/i,function(m,c,n){return n});this.setValue(h)},commit:function(h,k,l,g){g.removeAttribute("background");(h=this.getValue())?g.setStyle("background-image","url("+h+")"):b(g,"background-image","none")}},{type:"button",id:"bgImageChoose",label:o.browseServer,style:"display:inline-block;margin-top:10px;",hidden:!0,filebrowser:"design:bgImage"}]},{type:"checkbox",id:"bgFixed",label:v.bgFixed,setup:function(h,k,l,g){this.setValue("fixed"==g.getComputedStyle("background-attachment"))},commit:function(h,k,l,g){this.getValue()?g.setStyle("background-attachment","fixed"):b(g,"background-attachment","scroll")}}]},{type:"vbox",children:[{type:"html",id:"marginTitle",html:'\x3cdiv style\x3d"text-align: center; margin: 0px auto; font-weight: bold"\x3e'+v.margin+"\x3c/div\x3e"},{type:"text",id:"marginTop",label:v.marginTop,style:"width: 80px; text-align: center",align:"center",inputStyle:"text-align: center",setup:function(h,k,l,g){this.setValue(g.getStyle("margin-top")||g.getAttribute("margintop")||"")},commit:d("top")},{type:"hbox",children:[{type:"text",id:"marginLeft",label:v.marginLeft,style:"width: 80px; text-align: center",align:"center",inputStyle:"text-align: center",setup:function(h,k,l,g){this.setValue(g.getStyle("margin-left")||g.getAttribute("marginleft")||"")},commit:d("left")},{type:"text",id:"marginRight",label:v.marginRight,style:"width: 80px; text-align: center",align:"center",inputStyle:"text-align: center",setup:function(h,k,l,g){this.setValue(g.getStyle("margin-right")||g.getAttribute("marginright")||"")},commit:d("right")}]},{type:"text",id:"marginBottom",label:v.marginBottom,style:"width: 80px; text-align: center",align:"center",inputStyle:"text-align: center",setup:function(h,l,k,g){this.setValue(g.getStyle("margin-bottom")||g.getAttribute("marginbottom")||"")},commit:d("bottom")}]}]}]},{id:"meta",label:v.meta,elements:[{type:"textarea",id:"metaKeywords",label:v.metaKeywords,setup:i("keywords"),commit:j("keywords")},{type:"textarea",id:"metaDescription",label:v.metaDescription,setup:i("description"),commit:j("description")},{type:"text",id:"metaAuthor",label:v.metaAuthor,setup:i("author"),commit:j("author")},{type:"text",id:"metaCopyright",label:v.metaCopyright,setup:i("copyright"),commit:j("copyright")}]},{id:"preview",label:o.preview,elements:[{type:"html",id:"previewHtml",html:'\x3ciframe src\x3d"'+w+'" style\x3d"width: 100%; height: 310px" hidefocus\x3d"true" frameborder\x3d"0"\x3e\x3c/iframe\x3e',onLoad:function(){var c=this.getElement();this.getDialog().on("selectPage",function(h){if("preview"==h.data.page){var g=this;setTimeout(function(){var k=c.getFrameDocument(),n=k.getElementsByTag("html").getItem(0),m=k.getHead(),l=k.getBody();g.commitContent(k,n,m,l,1)},50)}});c.getAscendant("table").setStyle("height","100%")}}]}]}});