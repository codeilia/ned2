tinymce.PluginManager.add("preview",function(f){var d=f.settings,e=!tinymce.Env.ie;f.addCommand("mcePreview",function(){f.windowManager.open({title:"Preview",width:parseInt(f.getParam("plugin_preview_width","650"),10),height:parseInt(f.getParam("plugin_preview_height","500"),10),html:'<iframe src="javascript:\'\'" frameborder="0"'+(e?' sandbox="allow-scripts"':"")+"></iframe>",buttons:{text:"Close",onclick:function(){this.parent().parent().close()}},onPostRender:function(){var m,c="";c+='<base href="'+f.documentBaseURI.getURI()+'">';tinymce.each(f.contentCSS,function(g){c+='<link type="text/css" rel="stylesheet" href="'+f.documentBaseURI.toAbsolute(g)+'">'});var b=d.body_id||"tinymce";if(b.indexOf("=")!=-1){b=f.getParam("body_id","","hash");b=b[f.id]||b}var k=d.body_class||"";if(k.indexOf("=")!=-1){k=f.getParam("body_class","","hash");k=k[f.id]||""}var n=('<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A") {e.preventDefault();}}}, false);<\/script> ');var l=f.settings.directionality?' dir="'+f.settings.directionality+'"':"";m=("<!DOCTYPE html><html><head>"+c+'</head><body id="'+b+'" class="mce-content-body '+k+'"'+l+">"+f.getContent()+n+"</body></html>");if(!e){var a=this.getEl("body").firstChild.contentWindow.document;a.open();a.write(m);a.close()}else{this.getEl("body").firstChild.src="data:text/html;charset=utf-8,"+encodeURIComponent(m)}}})});f.addButton("preview",{title:"Preview",cmd:"mcePreview"});f.addMenuItem("preview",{text:"Preview",cmd:"mcePreview",context:"view"})});