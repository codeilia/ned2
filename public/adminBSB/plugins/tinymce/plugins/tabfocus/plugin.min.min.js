tinymce.PluginManager.add("tabfocus",function(k){var j=tinymce.DOM,i=tinymce.each,l=tinymce.explode;function h(a){if(a.keyCode===9&&!a.ctrlKey&&!a.altKey&&!a.metaKey){a.preventDefault()}}function g(a){var f,c,e,d;if(a.keyCode!==9||a.ctrlKey||a.altKey||a.metaKey||a.isDefaultPrevented()){return}function o(n){c=j.select(":input:enabled,*[tabindex]:not(iframe)");function q(p){return p.nodeName==="BODY"||(p.type!="hidden"&&p.style.display!="none"&&p.style.visibility!="hidden"&&q(p.parentNode))}function m(p){return/INPUT|TEXTAREA|BUTTON/.test(p.tagName)&&tinymce.get(a.id)&&p.tabIndex!=-1&&q(p)}i(c,function(p,s){if(p.id==k.id){f=s;return false}});if(n>0){for(d=f+1;d<c.length;d++){if(m(c[d])){return c[d]}}}else{for(d=f-1;d>=0;d--){if(m(c[d])){return c[d]}}}return null}e=l(k.getParam("tab_focus",k.getParam("tabfocus_elements",":prev,:next")));if(e.length==1){e[1]=e[0];e[0]=":prev"}if(a.shiftKey){if(e[0]==":prev"){c=o(-1)}else{c=j.get(e[0])}}else{if(e[1]==":next"){c=o(1)}else{c=j.get(e[1])}}if(c){var b=tinymce.get(c.id||c.name);if(c.id&&b){b.focus()}else{tinymce.util.Delay.setTimeout(function(){if(!tinymce.Env.webkit){window.focus()}c.focus()},10)}a.preventDefault()}}k.on("init",function(){if(k.inline){tinymce.DOM.setAttrib(k.getBody(),"tabIndex",null)}k.on("keyup",h);if(tinymce.Env.gecko){k.on("keypress keydown",g)}else{k.on("keydown",g)}})});