tinymce.PluginManager.add("visualblocks",function(k,l){var i,j,g;if(!window.NodeList){return}function h(){var a=this;a.active(g);k.on("VisualBlocks",function(){a.active(k.dom.hasClass(k.getBody(),"mce-visualblocks"))})}k.addCommand("mceVisualBlocks",function(){var a=k.dom,b;if(!i){i=a.uniqueId();b=a.create("link",{id:i,rel:"stylesheet",href:l+"/css/visualblocks.css"});k.getDoc().getElementsByTagName("head")[0].appendChild(b)}k.on("PreviewFormats AfterPreviewFormats",function(c){if(g){a.toggleClass(k.getBody(),"mce-visualblocks",c.type=="afterpreviewformats")}});a.toggleClass(k.getBody(),"mce-visualblocks");g=k.dom.hasClass(k.getBody(),"mce-visualblocks");if(j){j.active(a.hasClass(k.getBody(),"mce-visualblocks"))}k.fire("VisualBlocks")});k.addButton("visualblocks",{title:"Show blocks",cmd:"mceVisualBlocks",onPostRender:h});k.addMenuItem("visualblocks",{text:"Show blocks",cmd:"mceVisualBlocks",onPostRender:h,selectable:true,context:"view",prependToContext:true});k.on("init",function(){if(k.settings.visualblocks_default_state){k.execCommand("mceVisualBlocks",false,null,{skip_focus:true})}});k.on("remove",function(){k.dom.removeClass(k.getBody(),"mce-visualblocks")})});