(function(i,l){var o={};function p(a,e){var b,d=[];for(var c=0;c<a.length;++c){b=o[a[c]]||n(a[c]);if(!b){throw"module definition dependecy not found: "+a[c]}d.push(b)}e.apply(null,d)}function k(a,b,c){if(typeof a!=="string"){throw"invalid module definition, module id must be defined and be a string"}if(b===l){throw"invalid module definition, dependencies must be specified"}if(c===l){throw"invalid module definition, definition function must be specified"}p(b,function(){o[a]=c.apply(null,arguments)})}function m(a){return !!o[a]}function n(a){var c=i;var d=a.split(/[.\/]/);for(var b=0;b<d.length;++b){if(!c[d[b]]){return}c=c[d[b]]}return c}function j(b){var c,g,e,d,a;for(c=0;c<b.length;c++){g=i;e=b[c];d=e.split(/[.\/]/);for(var f=0;f<d.length-1;++f){if(g[d[f]]===l){g[d[f]]={}}g=g[d[f]]}g[d[d.length-1]]=o[e]}if(i.AMDLC_TESTS){a=i.privateModules||{};for(e in o){a[e]=o[e]}for(c=0;c<b.length;c++){delete a[b[c]]}i.privateModules=a}}k("tinymce/spellcheckerplugin/DomTextMatcher",[],function(){function a(b){return b&&b.nodeType==1&&b.contentEditable==="false"}return function(T,aa){var V,ac=[],R,h=aa.dom;var c,P,O;c=aa.schema.getBlockElements();P=aa.schema.getWhiteSpaceElements();O=aa.schema.getShortEndedElements();function N(q,r){if(!q[0]){throw"findAndReplaceDOMText cannot handle zero-length matches"}return{start:q.index,end:q.index+q[0].length,text:q[0],data:r}}function ae(r){var q;if(r.nodeType===3){return r.data}if(P[r.nodeName]&&!c[r.nodeName]){return""}if(a(r)){return"\n"}q="";if(c[r.nodeName]||O[r.nodeName]){q+="\n"}if((r=r.firstChild)){do{q+=ae(r)}while((r=r.nextSibling))}return q}function g(z,x,t){var B,u,w,A,s=[],v=0,y=z,r,q=0;x=x.slice(0);x.sort(function(D,C){return D.start-C.start});r=x.shift();out:while(true){if(c[y.nodeName]||O[y.nodeName]||a(y)){v++}if(y.nodeType===3){if(!u&&y.length+v>=r.end){u=y;A=r.end-v}else{if(B){s.push(y)}}if(!B&&y.length+v>r.start){B=y;w=r.start-v}v+=y.length}if(B&&u){y=t({startNode:B,startNodeIndex:w,endNode:u,endNodeIndex:A,innerNodes:s,match:r.text,matchIndex:q});v-=(u.length-A);B=null;u=null;s=[];r=x.shift();q++;if(!r){break}}else{if((!P[y.nodeName]||c[y.nodeName])&&y.firstChild){if(!a(y)){y=y.firstChild;continue}}else{if(y.nextSibling){y=y.nextSibling;continue}}}while(true){if(y.nextSibling){y=y.nextSibling;break}else{if(y.parentNode!==z){y=y.parentNode}else{break out}}}}}function L(r){function q(t,v){var u=ac[v];if(!u.stencil){u.stencil=r(u)}var s=u.stencil.cloneNode(false);s.setAttribute("data-mce-index",v);if(t){s.appendChild(h.doc.createTextNode(t))}return s}return function(A){var t,G,z,E=A.startNode,x=A.endNode,s=A.matchIndex,I=h.doc;if(E===x){var D=E;z=D.parentNode;if(A.startNodeIndex>0){t=I.createTextNode(D.data.substring(0,A.startNodeIndex));z.insertBefore(t,D)}var F=q(A.match,s);z.insertBefore(F,D);if(A.endNodeIndex<D.length){G=I.createTextNode(D.data.substring(A.endNodeIndex));z.insertBefore(G,D)}D.parentNode.removeChild(D);return F}t=I.createTextNode(E.data.substring(0,A.startNodeIndex));G=I.createTextNode(x.data.substring(A.endNodeIndex));var v=q(E.data.substring(A.startNodeIndex),s);var w=[];for(var B=0,C=A.innerNodes.length;B<C;++B){var H=A.innerNodes[B];var u=q(H.data,s);H.parentNode.replaceChild(u,H);w.push(u)}var y=q(x.data.substring(0,A.endNodeIndex),s);z=E.parentNode;z.insertBefore(t,E);z.insertBefore(v,E);z.removeChild(E);z=x.parentNode;z.insertBefore(y,x);z.insertBefore(G,x);z.removeChild(x);return y}}function Z(r){var q=r.parentNode;q.insertBefore(r.firstChild,r);r.parentNode.removeChild(r)}function Q(r){var s=T.getElementsByTagName("*"),t=[];r=typeof r=="number"?""+r:null;for(var u=0;u<s.length;u++){var v=s[u],q=v.getAttribute("data-mce-index");if(q!==null&&q.length){if(q===r||r===null){t.push(v)}}}return t}function ad(r){var q=ac.length;while(q--){if(ac[q]===r){return q}}return -1}function S(r){var q=[];ab(function(t,s){if(r(t,s)){q.push(t)}});ac=q;return this}function ab(s){for(var r=0,q=ac.length;r<q;r++){if(s(ac[r],r)===false){break}}return this}function U(q){if(ac.length){g(T,ac,L(q))}return this}function e(r,q){if(R&&r.global){while((V=r.exec(R))){ac.push(N(V,q))}}return this}function X(r){var q,s=Q(r?ad(r):null);q=s.length;while(q--){Z(s[q])}return this}function Y(q){return ac[q.getAttribute("data-mce-index")]}function M(q){return Q(ad(q))[0]}function f(s,r,q){ac.push({start:s,end:s+r,text:R.substr(s,r),data:q});return this}function W(r){var s=Q(ad(r));var q=aa.dom.createRng();q.setStartBefore(s[0]);q.setEndAfter(s[s.length-1]);return q}function d(r,s){var q=W(r);q.deleteContents();if(s.length>0){q.insertNode(aa.dom.doc.createTextNode(s))}return q}function b(){ac.splice(0,ac.length);X();return this}R=ae(T);return{text:R,matches:ac,each:ab,filter:S,reset:b,matchFromElement:Y,elementFromMatch:M,find:e,add:f,wrap:U,unwrap:X,replace:d,rangeFromMatch:W,indexOf:ad}}});k("tinymce/spellcheckerplugin/Plugin",["tinymce/spellcheckerplugin/DomTextMatcher","tinymce/PluginManager","tinymce/util/Tools","tinymce/ui/Menu","tinymce/dom/DOMUtils","tinymce/util/XHR","tinymce/util/URI","tinymce/util/JSON"],function(f,c,d,a,h,b,e,g){c.add("spellchecker",function(ao,ai){var Y,ar=this,R,aq,ae,V=ao.settings;var U;function S(){if(!ar.textMatcher){ar.textMatcher=new f(ao.getBody(),ao)}return ar.textMatcher}function ac(q,s){var r=[];d.each(s,function(t){r.push({selectable:true,text:t.name,data:t.value})});return r}var Z=V.spellchecker_languages||"English=en,Danish=da,Dutch=nl,Finnish=fi,French=fr_FR,German=de,Italian=it,Polish=pl,Portuguese=pt_BR,Spanish=es,Swedish=sv";Y=ac("Language",d.map(Z.split(","),function(q){q=q.split("=");return{name:q[0],value:q[1]}}));function aa(q){for(var r in q){return false}return true}function am(q,s){var t=[],v=R[q];d.each(v,function(x){t.push({text:x,onclick:function(){ao.insertContent(ao.dom.encode(x));ao.dom.remove(s);X()}})});t.push({text:"-"});if(U){t.push({text:"Add to Dictionary",onclick:function(){af(q,s)}})}t.push.apply(t,[{text:"Ignore",onclick:function(){an(q,s)}},{text:"Ignore all",onclick:function(){an(q,s,true)}}]);ae=new a({items:t,context:"contextmenu",onautohide:function(x){if(x.target.className.indexOf("spellchecker")!=-1){x.preventDefault()}},onhide:function(){ae.remove();ae=null}});ae.renderTo(document.body);var w=h.DOM.getPos(ao.getContentAreaContainer());var r=ao.dom.getPos(s[0]);var u=ao.dom.getRoot();if(u.nodeName=="BODY"){r.x-=u.ownerDocument.documentElement.scrollLeft||u.scrollLeft;r.y-=u.ownerDocument.documentElement.scrollTop||u.scrollTop}else{r.x-=u.scrollLeft;r.y-=u.scrollTop}w.x+=r.x;w.y+=r.y;ae.moveTo(w.x,w.y+s[0].offsetHeight)}function ag(){return ao.getParam("spellchecker_wordchar_pattern")||new RegExp('[^\\s!"#$%&()*+,-./:;<=>?@[\\]^_{|}`\u00a7\u00a9\u00ab\u00ae\u00b1\u00b6\u00b7\u00b8\u00bb\u00bc\u00bd\u00be\u00bf\u00d7\u00f7\u00a4\u201d\u201c\u201e\u00a0\u2002\u2003\u2009]+',"g")}function ak(q,r,u,t){var s={method:q,lang:V.spellchecker_language},v="";s[q=="addToDictionary"?"word":"text"]=r;d.each(s,function(w,x){if(v){v+="&"}v+=x+"="+encodeURIComponent(w)});b.send({url:new e(ai).toAbsolute(V.spellchecker_rpc_url),type:"post",content_type:"application/x-www-form-urlencoded",data:v,success:function(x){x=g.parse(x);if(!x){var w=ao.translate("Server response wasn't proper JSON.");t(w)}else{if(x.error){t(x.error)}else{u(x)}}},error:function(){var w=ao.translate("The spelling service was not found: (")+V.spellchecker_rpc_url+ao.translate(")");t(w)}})}function W(r,q,u,s){var t=V.spellchecker_callback||ak;t.call(ar,r,q,u,s)}function T(){if(ah()){return}function q(r){ao.notificationManager.open({text:r,type:"error"});ao.setProgressState(false);ah()}ao.setProgressState(true);W("spellcheck",S().text,ap,q);ao.focus()}function X(){if(!ao.dom.select("span.mce-spellchecker-word").length){ah()}}function af(q,r){ao.setProgressState(true);W("addToDictionary",q,function(){ao.setProgressState(false);ao.dom.remove(r,true);X()},function(s){ao.notificationManager.open({text:s,type:"error"});ao.setProgressState(false)})}function an(q,s,r){ao.selection.collapse();if(r){d.each(ao.dom.select("span.mce-spellchecker-word"),function(t){if(t.getAttribute("data-mce-word")==q){ao.dom.remove(t,true)}})}else{ao.dom.remove(s,true)}X()}function ah(){S().reset();ar.textMatcher=null;if(aq){aq=false;ao.fire("SpellcheckEnd");return true}}function ab(q){var r=q.getAttribute("data-mce-index");if(typeof r=="number"){return""+r}return r}function ad(t){var u,r=[];u=d.toArray(ao.getBody().getElementsByTagName("span"));if(u.length){for(var s=0;s<u.length;s++){var q=ab(u[s]);if(q===null||!q.length){continue}if(q===t.toString()){r.push(u[s])}}}return r}ao.on("click",function(q){var r=q.target;if(r.className=="mce-spellchecker-word"){q.preventDefault();var s=ad(ab(r));if(s.length>0){var t=ao.dom.createRng();t.setStartBefore(s[0]);t.setEndAfter(s[s.length-1]);ao.selection.setRng(t);am(r.getAttribute("data-mce-word"),s)}}});ao.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:T,selectable:true,onPostRender:function(){var q=this;q.active(aq);ao.on("SpellcheckStart SpellcheckEnd",function(){q.active(aq)})}});function aj(q){var r=V.spellchecker_language;q.control.items().each(function(s){s.active(s.settings.data===r)})}function ap(q){var s;if(q.words){U=!!q.dictionary;s=q.words}else{s=q}ao.setProgressState(false);if(aa(s)){var r=ao.translate("No misspellings found.");ao.notificationManager.open({text:r,type:"info"});aq=false;return}R=s;S().find(ag()).filter(function(t){return !!s[t.text]}).wrap(function(t){return ao.dom.create("span",{"class":"mce-spellchecker-word","data-mce-bogus":1,"data-mce-word":t.text})});aq=true;ao.fire("SpellcheckStart")}var al={tooltip:"Spellcheck",onclick:T,onPostRender:function(){var q=this;ao.on("SpellcheckStart SpellcheckEnd",function(){q.active(aq)})}};if(Y.length>1){al.type="splitbutton";al.menu=Y;al.onshow=aj;al.onselect=function(q){V.spellchecker_language=q.control.settings.data}}ao.addButton("spellchecker",al);ao.addCommand("mceSpellCheck",T);ao.on("remove",function(){if(ae){ae.remove();ae=null}});ao.on("change",X);this.getTextMatcher=S;this.getWordCharPattern=ag;this.markErrors=ap;this.getLanguage=function(){return V.spellchecker_language};V.spellchecker_language=V.spellchecker_language||V.language||"en"})});j(["tinymce/spellcheckerplugin/DomTextMatcher"])})(this);