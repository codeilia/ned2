tinymce.PluginManager.add("textcolor",function(f){var g,j;j={forecolor:f.settings.forecolor_rows||f.settings.textcolor_rows||5,backcolor:f.settings.backcolor_rows||f.settings.textcolor_rows||5};g={forecolor:f.settings.forecolor_cols||f.settings.textcolor_cols||8,backcolor:f.settings.backcolor_cols||f.settings.textcolor_cols||8};function a(l){var k;f.dom.getParents(f.selection.getStart(),function(n){var m;if((m=n.style[l=="forecolor"?"color":"background-color"])){k=m}});return k}function h(n){var m,k=[],l;l=["000000","Black","993300","Burnt orange","333300","Dark olive","003300","Dark green","003366","Dark azure","000080","Navy Blue","333399","Indigo","333333","Very dark gray","800000","Maroon","FF6600","Orange","808000","Olive","008000","Green","008080","Teal","0000FF","Blue","666699","Grayish blue","808080","Gray","FF0000","Red","FF9900","Amber","99CC00","Yellow green","339966","Sea green","33CCCC","Turquoise","3366FF","Royal blue","800080","Purple","999999","Medium gray","FF00FF","Magenta","FFCC00","Gold","FFFF00","Yellow","00FF00","Lime","00FFFF","Aqua","00CCFF","Sky blue","993366","Red violet","FFFFFF","White","FF99CC","Pink","FFCC99","Peach","FFFF99","Light yellow","CCFFCC","Pale green","CCFFFF","Pale cyan","99CCFF","Light sky blue","CC99FF","Plum"];l=f.settings.textcolor_map||l;l=f.settings[n+"_map"]||l;for(m=0;m<l.length;m+=2){k.push({text:l[m+1],color:"#"+l[m]})}return k}function b(){var k=this,l,n,p,v,u,t,o,m=k._id,q=0,s;s=k.settings.origin;function r(w,y){var x=w=="transparent";return('<td class="mce-grid-cell'+(x?" mce-colorbtn-trans":"")+'"><div id="'+m+"-"+(q++)+'" data-mce-color="'+(w?w:"")+'" role="option" tabIndex="-1" style="'+(w?"background-color: "+w:"")+'" title="'+tinymce.translate(y)+'">'+(x?"&#215;":"")+"</div></td>")}l=h(s);l.push({text:tinymce.translate("No color"),color:"transparent"});p='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="list" cellspacing="0"><tbody>';v=l.length-1;for(t=0;t<j[s];t++){p+="<tr>";for(u=0;u<g[s];u++){o=t*g[s]+u;if(o>v){p+="<td></td>"}else{n=l[o];p+=r(n.color,n.text)}}p+="</tr>"}if(f.settings.color_picker_callback){p+=('<tr><td colspan="'+g[s]+'" class="mce-custom-color-btn"><div id="'+m+'-c" class="mce-widget mce-btn mce-btn-small mce-btn-flat" role="button" tabindex="-1" aria-labelledby="'+m+'-c" style="width: 100%"><button type="button" role="presentation" tabindex="-1">'+tinymce.translate("Custom...")+"</button></div></td></tr>");p+="<tr>";for(u=0;u<g[s];u++){p+=r("","Custom color")}p+="</tr>"}p+="</tbody></table>";return p}function c(l,k){f.undoManager.transact(function(){f.focus();f.formatter.apply(l,{value:k});f.nodeChanged()})}function i(k){f.undoManager.transact(function(){f.focus();f.formatter.remove(k,{value:null},null,true);f.nodeChanged()})}function d(q){var m=this.parent(),p,n;n=m.settings.origin;function l(r){m.hidePanel();m.color(r);c(m.settings.format,r)}function o(){m.hidePanel();m.resetColor();i(m.settings.format)}function k(s,r){s.style.background=r;s.setAttribute("data-mce-color",r)}if(tinymce.DOM.getParent(q.target,".mce-custom-color-btn")){m.hidePanel();f.settings.color_picker_callback.call(f,function(u){var r=m.panel.getEl().getElementsByTagName("table")[0];var t,v,s;t=tinymce.map(r.rows[r.rows.length-1].childNodes,function(w){return w.firstChild});for(s=0;s<t.length;s++){v=t[s];if(!v.getAttribute("data-mce-color")){break}}if(s==g[n]){for(s=0;s<g[n]-1;s++){k(t[s],t[s+1].getAttribute("data-mce-color"))}}k(v,u);l(u)},a(m.settings.format))}p=q.target.getAttribute("data-mce-color");if(p){if(this.lastId){document.getElementById(this.lastId).setAttribute("aria-selected",false)}q.target.setAttribute("aria-selected",true);this.lastId=q.target.id;if(p=="transparent"){o()}else{l(p)}}else{if(p!==null){m.hidePanel()}}}function e(){var k=this;if(k._color){c(k.settings.format,k._color)}else{i(k.settings.format)}}f.addButton("forecolor",{type:"colorbutton",tooltip:"Text color",format:"forecolor",panel:{origin:"forecolor",role:"application",ariaRemember:true,html:b,onclick:d},onclick:e});f.addButton("backcolor",{type:"colorbutton",tooltip:"Background color",format:"hilitecolor",panel:{origin:"backcolor",role:"application",ariaRemember:true,html:b,onclick:d},onclick:e})});