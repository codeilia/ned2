tinymce.PluginManager.add("autolink",function(l){var h;var i=/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@)(.+)$/i;if(l.settings.autolink_pattern){i=l.settings.autolink_pattern}l.on("keydown",function(a){if(a.keyCode==13){return m(l)}});if(tinymce.Env.ie){l.on("focus",function(){if(!h){h=true;try{l.execCommand("AutoUrlDetect",false,true)}catch(a){}}});return}l.on("keypress",function(a){if(a.keyCode==41){return k(l)}});l.on("keyup",function(a){if(a.keyCode==32){return n(l)}});function k(a){j(a,-1,"(",true)}function n(a){j(a,0,"",true)}function m(a){j(a,-1,"",false)}function j(b,g,z){var A,e,x,B,E,C,d,f,c,D;function y(q,p){if(p<0){p=0}if(q.nodeType==3){var o=q.data.length;if(p>o){p=o}}return p}function F(o,p){if(o.nodeType!=1||o.hasChildNodes()){A.setStart(o,y(o,p))}else{A.setStartBefore(o)}}function a(o,p){if(o.nodeType!=1||o.hasChildNodes()){A.setEnd(o,y(o,p))}else{A.setEndAfter(o)}}if(b.selection.getNode().tagName=="A"){return}A=b.selection.getRng(true).cloneRange();if(A.startOffset<5){f=A.endContainer.previousSibling;if(!f){if(!A.endContainer.firstChild||!A.endContainer.firstChild.nextSibling){return}f=A.endContainer.firstChild.nextSibling}c=f.length;F(f,c);a(f,c);if(A.endOffset<5){return}e=A.endOffset;B=f}else{B=A.endContainer;if(B.nodeType!=3&&B.firstChild){while(B.nodeType!=3&&B.firstChild){B=B.firstChild}if(B.nodeType==3){F(B,0);a(B,B.nodeValue.length)}}if(A.endOffset==1){e=2}else{e=A.endOffset-1-g}}x=e;do{F(B,e>=2?e-2:0);a(B,e>=1?e-1:0);e-=1;D=A.toString()}while(D!=" "&&D!==""&&D.charCodeAt(0)!=160&&(e-2)>=0&&D!=z);if(A.toString()==z||A.toString().charCodeAt(0)==160){F(B,e);a(B,x);e+=1}else{if(A.startOffset===0){F(B,0);a(B,x)}else{F(B,e);a(B,x)}}C=A.toString();if(C.charAt(C.length-1)=="."){a(B,x-1)}C=A.toString();d=C.match(i);if(d){if(d[1]=="www."){d[1]="http://www."}else{if(/@$/.test(d[1])&&!/^mailto:/.test(d[1])){d[1]="mailto:"+d[1]}}E=b.selection.getBookmark();b.selection.setRng(A);b.execCommand("createlink",false,d[1]+d[2]);b.selection.moveToBookmark(E);b.nodeChanged()}}});