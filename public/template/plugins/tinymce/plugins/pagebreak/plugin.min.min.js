tinymce.PluginManager.add("pagebreak",function(j){var i="mce-pagebreak",g=j.getParam("pagebreak_separator","<!-- pagebreak -->");var h=new RegExp(g.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(a){return"\\"+a}),"gi");var f='<img src="'+tinymce.Env.transparentSrc+'" class="'+i+'" data-mce-resize="false" data-mce-placeholder />';j.addCommand("mcePageBreak",function(){if(j.settings.pagebreak_split_block){j.insertContent("<p>"+f+"</p>")}else{j.insertContent(f)}});j.addButton("pagebreak",{title:"Page break",cmd:"mcePageBreak"});j.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"});j.on("ResolveName",function(a){if(a.target.nodeName=="IMG"&&j.dom.hasClass(a.target,i)){a.name="pagebreak"}});j.on("click",function(a){a=a.target;if(a.nodeName==="IMG"&&j.dom.hasClass(a,i)){j.selection.select(a)}});j.on("BeforeSetContent",function(a){a.content=a.content.replace(h,f)});j.on("PreInit",function(){j.serializer.addNodeFilter("img",function(d){var c=d.length,a,b;while(c--){a=d[c];b=a.attr("class");if(b&&b.indexOf("mce-pagebreak")!==-1){var e=a.parent;if(j.schema.getBlockElements()[e.name]&&j.settings.pagebreak_split_block){e.type=3;e.value=g;e.raw=true;a.remove();continue}a.type=3;a.value=g;a.raw=true}}})})});