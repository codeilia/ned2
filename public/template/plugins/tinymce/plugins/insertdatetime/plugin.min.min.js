tinymce.PluginManager.add("insertdatetime",function(o){var k="Sun Mon Tue Wed Thu Fri Sat Sun".split(" ");var s="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" ");var n="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");var p="January February March April May June July August September October November December".split(" ");var t=[],q,l;function r(c,a){function b(d,f){d=""+d;if(d.length<f){for(var e=0;e<(f-d.length);e++){d="0"+d}}return d}a=a||new Date();c=c.replace("%D","%m/%d/%Y");c=c.replace("%r","%I:%M:%S %p");c=c.replace("%Y",""+a.getFullYear());c=c.replace("%y",""+a.getYear());c=c.replace("%m",b(a.getMonth()+1,2));c=c.replace("%d",b(a.getDate(),2));c=c.replace("%H",""+b(a.getHours(),2));c=c.replace("%M",""+b(a.getMinutes(),2));c=c.replace("%S",""+b(a.getSeconds(),2));c=c.replace("%I",""+((a.getHours()+11)%12+1));c=c.replace("%p",""+(a.getHours()<12?"AM":"PM"));c=c.replace("%B",""+o.translate(p[a.getMonth()]));c=c.replace("%b",""+o.translate(n[a.getMonth()]));c=c.replace("%A",""+o.translate(s[a.getDay()]));c=c.replace("%a",""+o.translate(k[a.getDay()]));c=c.replace("%%","%");return c}function m(a){var b=r(a);if(o.settings.insertdatetime_element){var c;if(/%[HMSIp]/.test(a)){c=r("%Y-%m-%dT%H:%M")}else{c=r("%Y-%m-%d")}b='<time datetime="'+c+'">'+b+"</time>";var d=o.dom.getParent(o.selection.getStart(),"time");if(d){o.dom.setOuterHTML(d,b);return}}o.insertContent(b)}o.addCommand("mceInsertDate",function(){m(o.getParam("insertdatetime_dateformat",o.translate("%Y-%m-%d")))});o.addCommand("mceInsertTime",function(){m(o.getParam("insertdatetime_timeformat",o.translate("%H:%M:%S")))});o.addButton("insertdatetime",{type:"splitbutton",title:"Insert date/time",onclick:function(){m(q||l)},menu:t});tinymce.each(o.settings.insertdatetime_formats||["%H:%M:%S","%Y-%m-%d","%I:%M:%S %p","%D"],function(a){if(!l){l=a}t.push({text:r(a),onclick:function(){q=a;m(a)}})});o.addMenuItem("insertdatetime",{icon:"date",text:"Insert date/time",menu:t,context:"insert"})});