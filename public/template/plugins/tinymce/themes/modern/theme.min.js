tinymce.ThemeManager.add("modern",function(e){var l=this,r=e.settings,p=tinymce.ui.Factory,c=tinymce.each,s=tinymce.DOM,h=tinymce.geom.Rect,o=tinymce.ui.FloatPanel;var k={file:{title:"File",items:"newdocument"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall"},insert:{title:"Insert",items:"|"},view:{title:"View",items:"visualaid |"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript | formats | removeformat"},table:{title:"Table"},tools:{title:"Tools"}};var d="undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image";function a(v,w){var x=[],u;if(!v){return}c(v.split(/[ ,]/),function(z){var A;function y(){var B=e.selection;function C(D){return function(G,E){var H,F=E.parents.length;while(F--){H=E.parents[F].nodeName;if(H=="OL"||H=="UL"){break}}z.active(G&&H==D)}}if(A=="bullist"){B.selectorChanged("ul > li",C("UL"))}if(A=="numlist"){B.selectorChanged("ol > li",C("OL"))}if(z.settings.stateSelector){B.selectorChanged(z.settings.stateSelector,function(D){z.active(D)},true)}if(z.settings.disabledStateSelector){B.selectorChanged(z.settings.disabledStateSelector,function(D){z.disabled(D)})}}if(z=="|"){u=null}else{if(p.has(z)){z={type:z,size:w};x.push(z);u=null}else{if(!u){u={type:"buttongroup",items:[]};x.push(u)}if(e.buttons[z]){A=z;z=e.buttons[A];if(typeof z=="function"){z=z()}z.type=z.type||"button";z.size=w;z=p.create(z);u.items.push(z);if(e.initialized){y()}else{e.on("init",y)}}}}});return{type:"toolbar",layout:"flow",items:x}}function f(v){var w=[];function x(y){if(y){w.push(a(y,v));return true}}if(tinymce.isArray(r.toolbar)){if(r.toolbar.length===0){return}tinymce.each(r.toolbar,function(z,y){r["toolbar"+(y+1)]=z});delete r.toolbar}for(var u=1;u<10;u++){if(!x(r["toolbar"+u])){break}}if(!w.length&&r.toolbar!==false){x(r.toolbar||d)}if(w.length){return{type:"panel",layout:"stack",classes:"toolbar-grp",ariaRoot:true,ariaRemember:true,items:w}}}function t(){var w,B=[];function z(C){var D;if(C=="|"){return{text:"|"}}D=e.menuItems[C];return D}function u(G){var C,H,F,I,E;E=tinymce.makeMap((r.removed_menuitems||"").split(/[ ,]/));if(r.menu){H=r.menu[G];I=true}else{H=k[G]}if(H){C={text:H.title};F=[];c((H.items||"").split(/[ ,]/),function(K){var J=z(K);if(J&&!E[K]){F.push(z(K))}});if(!I){c(e.menuItems,function(J){if(J.context==G){if(J.separator=="before"){F.push({text:"|"})}if(J.prependToContext){F.unshift(J)}else{F.push(J)}if(J.separator=="after"){F.push({text:"|"})}}})}for(var D=0;D<F.length;D++){if(F[D].text=="|"){if(D===0||D==F.length-1){F.splice(D,1)}}}C.menu=F;if(!C.menu.length){return null}}return C}var v=[];if(r.menu){for(w in r.menu){v.push(w)}}else{for(w in k){v.push(w)}}var y=typeof r.menubar=="string"?r.menubar.split(/[ ,]/):v;for(var x=0;x<y.length;x++){var A=y[x];A=u(A);if(A){B.push(A)}}return B}function j(v){function u(w){var x=v.find(w)[0];if(x){x.focus(true)}}e.shortcuts.add("Alt+F9","",function(){u("menubar")});e.shortcuts.add("Alt+F10","",function(){u("toolbar")});e.shortcuts.add("Alt+F11","",function(){u("elementpath")});v.on("cancel",function(){e.focus()})}function m(w,v){var A,u,y,z;function x(B){return{width:B.clientWidth,height:B.clientHeight}}A=e.getContainer();u=e.getContentAreaContainer().firstChild;y=x(A);z=x(u);if(w!==null){w=Math.max(r.min_width||100,w);w=Math.min(r.max_width||65535,w);s.setStyle(A,"width",w+(y.width-z.width));s.setStyle(u,"width",w)}v=Math.max(r.min_height||100,v);v=Math.min(r.max_height||65535,v);s.setStyle(u,"height",v);e.fire("ResizeEditor")}function g(u,v){var w=e.getContentAreaContainer();l.resizeTo(w.clientWidth+u,w.clientHeight+v)}function q(){var D;function y(){return e.contextToolbars||[]}function F(L){var K,J,I;K=tinymce.DOM.getPos(e.getContentAreaContainer());J=e.dom.getRect(L);I=e.dom.getRoot();if(I.nodeName=="BODY"){J.x-=I.ownerDocument.documentElement.scrollLeft||I.scrollLeft;J.y-=I.ownerDocument.documentElement.scrollTop||I.scrollTop}J.x+=K.x;J.y+=K.y;return J}function B(){c(e.contextToolbars,function(I){if(I.panel){I.panel.hide()}})}function z(K,J,I){J=J?J.substr(0,2):"";c({t:"down",b:"up"},function(L,M){K.classes.toggle("arrow-"+L,I(M,J.substr(0,1)))});c({l:"left",r:"right"},function(L,M){K.classes.toggle("arrow-"+L,I(M,J.substr(1,1)))})}function A(I){return{left:I.x,top:I.y,width:I.w,height:I.h,right:I.x+I.w,bottom:I.y+I.h}}function H(I,M,K,L,J){J=A({x:I,y:M,w:J.w,h:J.h});if(r.inline_toolbar_position_handler){J=r.inline_toolbar_position_handler({elementRect:A(K),contentAreaRect:A(L),panelRect:J})}return J}function C(I,J){I.moveTo(J.left,J.top)}function G(L){var Q,K,O,N,I,M,J,P;if(e.removed){return}if(!L||!L.toolbar.panel){B();return}J=["bc-tc","tc-bc","tl-bl","bl-tl","tr-br","br-tr"];I=L.toolbar.panel;I.show();O=F(L.element);K=tinymce.DOM.getRect(I.getEl());N=tinymce.DOM.getRect(e.getContentAreaContainer()||e.getBody());P=25;O.w=L.element.clientWidth;O.h=L.element.clientHeight;if(!e.inline){N.w=e.getDoc().documentElement.offsetWidth}if(e.selection.controlSelection.isResizable(L.element)&&O.w<P){O=h.inflate(O,0,8)}Q=h.findBestRelativePosition(K,O,N,J);O=h.clamp(O,N);if(Q){M=h.relativePosition(K,O,Q);C(I,H(M.x,M.y,O,N,K))}else{N.h+=K.h;O=h.intersect(N,O);if(O){Q=h.findBestRelativePosition(K,O,N,["bc-tc","bl-tl","br-tr"]);if(Q){M=h.relativePosition(K,O,Q);C(I,H(M.x,M.y,O,N,K))}else{C(I,H(O.x,O.y,O,N,K))}}else{I.hide()}}z(I,Q,function(S,R){return S===R})}function v(){function I(){if(e.selection){G(u(e.selection.getNode()))}}tinymce.util.Delay.requestAnimationFrame(I)}function E(){if(!D){D=e.selection.getScrollContainer()||e.getWin();tinymce.$(D).on("scroll",v);e.on("remove",function(){tinymce.$(D).off("scroll")})}}function x(J){var I;if(J.toolbar.panel){J.toolbar.panel.show();G(J);return}E();I=p.create({type:"floatpanel",role:"dialog",classes:"tinymce tinymce-inline arrow",ariaLabel:"Inline toolbar",layout:"flex",direction:"column",align:"stretch",autohide:false,autofix:true,fixed:true,border:1,items:a(J.toolbar.items),oncancel:function(){e.focus()}});J.toolbar.panel=I;I.renderTo(document.body).reflow();G(J)}function w(){tinymce.each(y(),function(I){if(I.panel){I.panel.hide()}})}function u(K){var J,M,I,L=y();I=e.$(K).parents().add(K);for(J=I.length-1;J>=0;J--){for(M=L.length-1;M>=0;M--){if(L[M].predicate(I[J])){return{toolbar:L[M],element:I[J]}}}}return null}e.on("click keyup setContent",function(I){if(I.type=="setcontent"&&!I.selection){return}tinymce.util.Delay.setEditorTimeout(e,function(){var J;J=u(e.selection.getNode());if(J){w();x(J)}else{w()}})});e.on("blur hide",w);e.on("ObjectResizeStart",function(){var I=u(e.selection.getNode());if(I&&I.toolbar.panel){I.toolbar.panel.hide()}});e.on("nodeChange ResizeEditor ResizeWindow",v);e.on("remove",function(){tinymce.each(y(),function(I){if(I.panel){I.panel.remove()}});e.contextToolbars={}});e.shortcuts.add("ctrl+shift+e > ctrl+shift+p","",function(){var I=u(e.selection.getNode());if(I&&I.toolbar.panel){I.toolbar.panel.items()[0].focus()}})}function n(u){return function(){if(u.initialized){u.fire("SkinLoaded")}else{u.on("init",function(){u.fire("SkinLoaded")})}}}function i(x){var w,A;if(r.fixed_toolbar_container){A=s.select(r.fixed_toolbar_container)[0]}function v(){if(w&&w.moveRel&&w.visible()&&!w._fixed){var F=e.selection.getScrollContainer(),C=e.getBody();var D=0,B=0;if(F){var G=s.getPos(C),E=s.getPos(F);D=Math.max(0,E.x-G.x);B=Math.max(0,E.y-G.y)}w.fixed(false).moveRel(C,e.rtl?["tr-br","br-tr"]:["tl-bl","bl-tl","tr-br"]).moveBy(D,B)}}function u(){if(w){w.show();v();s.addClass(e.getBody(),"mce-edit-focus")}}function y(){if(w){w.hide();o.hideAll();s.removeClass(e.getBody(),"mce-edit-focus")}}function z(){if(w){if(!w.visible()){u()}return}w=l.panel=p.create({type:A?"panel":"floatpanel",role:"application",classes:"tinymce tinymce-inline",layout:"flex",direction:"column",align:"stretch",autohide:false,autofix:true,fixed:!!A,border:1,items:[r.menubar===false?null:{type:"menubar",border:"0 0 1 0",items:t()},f(r.toolbar_items_size)]});e.fire("BeforeRenderUI");w.renderTo(A||document.body).reflow();j(w);u();q();e.on("nodeChange",v);e.on("activate",u);e.on("deactivate",y);e.nodeChanged()}r.content_editable=true;e.on("focus",function(){if(x.skinUiCss){tinymce.DOM.styleSheetLoader.load(x.skinUiCss,z,z)}else{z()}});e.on("blur hide",y);e.on("remove",function(){if(w){w.remove();w=null}});if(x.skinUiCss){tinymce.DOM.styleSheetLoader.load(x.skinUiCss,n(e))}return{}}function b(w){var v,x,u;function y(){return function(z){if(z.mode=="readonly"){v.find("*").disabled(true)}else{v.find("*").disabled(false)}}}if(w.skinUiCss){tinymce.DOM.styleSheetLoader.load(w.skinUiCss,n(e))}v=l.panel=p.create({type:"panel",role:"application",classes:"tinymce",style:"visibility: hidden",layout:"stack",border:1,items:[r.menubar===false?null:{type:"menubar",border:"0 0 1 0",items:t()},f(r.toolbar_items_size),{type:"panel",name:"iframe",layout:"stack",classes:"edit-area",html:"",border:"1 0 0 0"}]});if(r.resize!==false){x={type:"resizehandle",direction:r.resize,onResizeStart:function(){var z=e.getContentAreaContainer().firstChild;u={width:z.clientWidth,height:z.clientHeight}},onResize:function(z){if(r.resize=="both"){m(u.width+z.deltaX,u.height+z.deltaY)}else{m(null,u.height+z.deltaY)}}}}if(r.statusbar!==false){v.add({type:"panel",name:"statusbar",classes:"statusbar",layout:"flow",border:"1 0 0 0",ariaRoot:true,items:[{type:"elementpath",editor:e},x]})}e.fire("BeforeRenderUI");e.on("SwitchMode",y());v.renderBefore(w.targetNode).reflow();if(r.readonly){e.setMode("readonly")}if(r.width){tinymce.DOM.setStyle(v.getEl(),"width",r.width)}e.on("remove",function(){v.remove();v=null});j(v);q();return{iframeContainer:v.find("#iframe")[0].getEl(),editorContainer:v.getEl()}}l.renderUI=function(v){var w=r.skin!==false?r.skin||"lightgray":false;if(w){var u=r.skin_url;if(u){u=e.documentBaseURI.toAbsolute(u)}else{u=tinymce.baseURL+"/skins/"+w}if(tinymce.Env.documentMode<=7){v.skinUiCss=u+"/skin.ie7.min.css"}else{v.skinUiCss=u+"/skin.min.css"}e.contentCSS.push(u+"/content"+(e.inline?".inline":"")+".min.css")}e.on("ProgressState",function(x){l.throbber=l.throbber||new tinymce.ui.Throbber(l.panel.getEl("body"));if(x.state){l.throbber.show(x.time)}else{l.throbber.hide()}});if(r.inline){return i(v)}return b(v)};l.resizeTo=m;l.resizeBy=g});