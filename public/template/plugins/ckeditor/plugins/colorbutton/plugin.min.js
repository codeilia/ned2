CKEDITOR.plugins.add("colorbutton",{requires:"panelbutton,floatpanel",lang:"af,ar,bg,bn,bs,ca,cs,cy,da,de,de-ch,el,en,en-au,en-ca,en-gb,eo,es,et,eu,fa,fi,fo,fr,fr-ca,gl,gu,he,hi,hr,hu,id,is,it,ja,ka,km,ko,ku,lt,lv,mk,mn,ms,nb,nl,no,pl,pt,pt-br,ro,ru,si,sk,sl,sq,sr,sr-latn,sv,th,tr,tt,ug,uk,vi,zh,zh-cn",icons:"bgcolor,textcolor",hidpi:!0,init:function(h){function f(n,i,k,j){var g=new CKEDITOR.style(a["colorButton_"+i+"Style"]),c=CKEDITOR.tools.getNextId()+"_colorBox";h.ui.add(n,CKEDITOR.UI_PANELBUTTON,{label:k,title:k,modes:{wysiwyg:1},editorFocus:0,toolbar:"colors,"+j,allowedContent:g,requiredContent:g,panel:{css:CKEDITOR.skin.getPath("editor"),attributes:{role:"listbox","aria-label":e.panelTitle}},onBlock:function(m,l){l.autoSize=!0;l.element.addClass("cke_colorblock");l.element.setHtml(b(m,i,c));l.element.getDocument().getBody().setStyle("overflow","hidden");CKEDITOR.ui.fire("ready",this);var p=l.keys,o="rtl"==h.lang.dir;p[o?37:39]="next";p[40]="next";p[9]="next";p[o?39:37]="prev";p[38]="prev";p[CKEDITOR.SHIFT+9]="prev";p[32]="click"},refresh:function(){h.activeFilter.check(g)||this.setState(CKEDITOR.TRISTATE_DISABLED)},onOpen:function(){var m=h.getSelection(),m=m&&m.getStartElement(),m=h.elementPath(m),l;if(m){m=m.block||m.blockLimit||h.document.getBody();do{l=m&&m.getComputedStyle("back"==i?"background-color":"color")||"transparent"}while("back"==i&&"transparent"==l&&m&&(m=m.getParent()));l&&"transparent"!=l||(l="#ffffff");!1!==a.colorButton_enableAutomatic&&this._.panel._.iframe.getFrameDocument().getById(c).setStyle("background-color",l);return l}}})}function b(g,o,s){var r=[],k=a.colorButton_colors.split(","),j=h.plugins.colordialog&&!1!==a.colorButton_enableMore,v=k.length+(j?2:1),u=CKEDITOR.tools.addFunction(function(m,l){function q(w){this.removeListener("ok",q);this.removeListener("cancel",q);"ok"==w.name&&p(this.getContentElement("picker","selectedColor").getValue(),l)}var p=arguments.callee;if("?"==m){h.openDialog("colordialog",function(){this.on("ok",q);this.on("cancel",q)})}else{h.focus();g.hide();h.fire("saveSnapshot");h.removeStyle(new CKEDITOR.style(a["colorButton_"+l+"Style"],{color:"inherit"}));if(m){var n=a["colorButton_"+l+"Style"];n.childRule="back"==l?function(w){return d(w)}:function(w){return !(w.is("a")||w.getElementsByTag("a").count())||d(w)};h.applyStyle(new CKEDITOR.style(n,{color:m}))}h.fire("saveSnapshot")}});!1!==a.colorButton_enableAutomatic&&r.push('\x3ca class\x3d"cke_colorauto" _cke_focus\x3d1 hidefocus\x3dtrue title\x3d"',e.auto,'" onclick\x3d"CKEDITOR.tools.callFunction(',u,",null,'",o,"');return false;\" href\x3d\"javascript:void('",e.auto,'\')" role\x3d"option" aria-posinset\x3d"1" aria-setsize\x3d"',v,'"\x3e\x3ctable role\x3d"presentation" cellspacing\x3d0 cellpadding\x3d0 width\x3d"100%"\x3e\x3ctr\x3e\x3ctd\x3e\x3cspan class\x3d"cke_colorbox" id\x3d"',s,'"\x3e\x3c/span\x3e\x3c/td\x3e\x3ctd colspan\x3d7 align\x3dcenter\x3e',e.auto,"\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/a\x3e");r.push('\x3ctable role\x3d"presentation" cellspacing\x3d0 cellpadding\x3d0 width\x3d"100%"\x3e');for(s=0;s<k.length;s++){0===s%8&&r.push("\x3c/tr\x3e\x3ctr\x3e");var t=k[s].split("/"),i=t[0],c=t[1]||i;t[1]||(i="#"+i.replace(/^(.)(.)(.)$/,"$1$1$2$2$3$3"));t=h.lang.colorbutton.colors[c]||c;r.push('\x3ctd\x3e\x3ca class\x3d"cke_colorbox" _cke_focus\x3d1 hidefocus\x3dtrue title\x3d"',t,'" onclick\x3d"CKEDITOR.tools.callFunction(',u,",'",i,"','",o,"'); return false;\" href\x3d\"javascript:void('",t,'\')" role\x3d"option" aria-posinset\x3d"',s+2,'" aria-setsize\x3d"',v,'"\x3e\x3cspan class\x3d"cke_colorbox" style\x3d"background-color:#',c,'"\x3e\x3c/span\x3e\x3c/a\x3e\x3c/td\x3e')}j&&r.push('\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d8 align\x3dcenter\x3e\x3ca class\x3d"cke_colormore" _cke_focus\x3d1 hidefocus\x3dtrue title\x3d"',e.more,'" onclick\x3d"CKEDITOR.tools.callFunction(',u,",'?','",o,"');return false;\" href\x3d\"javascript:void('",e.more,"')\"",' role\x3d"option" aria-posinset\x3d"',v,'" aria-setsize\x3d"',v,'"\x3e',e.more,"\x3c/a\x3e\x3c/td\x3e");r.push("\x3c/tr\x3e\x3c/table\x3e");return r.join("")}function d(g){return"false"==g.getAttribute("contentEditable")||g.getAttribute("data-nostyle")}var a=h.config,e=h.lang.colorbutton;CKEDITOR.env.hc||(f("TextColor","fore",e.textColorTitle,10),f("BGColor","back",e.bgColorTitle,20))}});CKEDITOR.config.colorButton_colors="000,800000,8B4513,2F4F4F,008080,000080,4B0082,696969,B22222,A52A2A,DAA520,006400,40E0D0,0000CD,800080,808080,F00,FF8C00,FFD700,008000,0FF,00F,EE82EE,A9A9A9,FFA07A,FFA500,FFFF00,00FF00,AFEEEE,ADD8E6,DDA0DD,D3D3D3,FFF0F5,FAEBD7,FFFFE0,F0FFF0,F0FFFF,F0F8FF,E6E6FA,FFF";CKEDITOR.config.colorButton_foreStyle={element:"span",styles:{color:"#(color)"},overrides:[{element:"font",attributes:{color:null}}]};CKEDITOR.config.colorButton_backStyle={element:"span",styles:{"background-color":"#(color)"}};