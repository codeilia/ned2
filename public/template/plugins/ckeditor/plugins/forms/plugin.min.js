CKEDITOR.plugins.add("forms",{requires:"dialog,fakeobjects",lang:"af,ar,bg,bn,bs,ca,cs,cy,da,de,de-ch,el,en,en-au,en-ca,en-gb,eo,es,et,eu,fa,fi,fo,fr,fr-ca,gl,gu,he,hi,hr,hu,id,is,it,ja,ka,km,ko,ku,lt,lv,mk,mn,ms,nb,nl,no,pl,pt,pt-br,ro,ru,si,sk,sl,sq,sr,sr-latn,sv,th,tr,tt,ug,uk,vi,zh,zh-cn",icons:"button,checkbox,form,hiddenfield,imagebutton,radio,select,select-rtl,textarea,textarea-rtl,textfield",hidpi:!0,onLoad:function(){CKEDITOR.addCss(".cke_editable form{border: 1px dotted #FF0000;padding: 2px;}\n");CKEDITOR.addCss("img.cke_hidden{background-image: url("+CKEDITOR.getUrl(this.path+"images/hiddenfield.gif")+");background-position: center center;background-repeat: no-repeat;border: 1px solid #a9a9a9;width: 16px !important;height: 16px !important;}")},init:function(r){var q=r.lang,n=0,j={email:1,password:1,search:1,tel:1,text:1,url:1},d={checkbox:"input[type,name,checked,required]",radio:"input[type,name,checked,required]",textfield:"input[type,name,value,size,maxlength,required]",textarea:"textarea[cols,rows,name,required]",select:"select[name,size,multiple,required]; option[value,selected]",button:"input[type,name,value]",form:"form[action,name,id,enctype,target,method]",hiddenfield:"input[type,name,value]",imagebutton:"input[type,alt,src]{width,height,border,border-width,border-style,margin,float}"},c={checkbox:"input",radio:"input",textfield:"input",textarea:"textarea",select:"select",button:"input",form:"form",hiddenfield:"input",imagebutton:"input"},p=function(f,g,b){var a={allowedContent:d[g],requiredContent:c[g]};"form"==g&&(a.context="form");r.addCommand(g,new CKEDITOR.dialogCommand(g,a));r.ui.addButton&&r.ui.addButton(f,{label:q.common[f.charAt(0).toLowerCase()+f.slice(1)],command:g,toolbar:"forms,"+(n+=10)});CKEDITOR.dialog.add(g,b)},o=this.path+"dialogs/";!r.blockless&&p("Form","form",o+"form.js");p("Checkbox","checkbox",o+"checkbox.js");p("Radio","radio",o+"radio.js");p("TextField","textfield",o+"textfield.js");p("Textarea","textarea",o+"textarea.js");p("Select","select",o+"select.js");p("Button","button",o+"button.js");var i=r.plugins.image;i&&!r.plugins.image2&&p("ImageButton","imagebutton",CKEDITOR.plugins.getPath("image")+"dialogs/image.js");p("HiddenField","hiddenfield",o+"hiddenfield.js");r.addMenuItems&&(p={checkbox:{label:q.forms.checkboxAndRadio.checkboxTitle,command:"checkbox",group:"checkbox"},radio:{label:q.forms.checkboxAndRadio.radioTitle,command:"radio",group:"radio"},textfield:{label:q.forms.textfield.title,command:"textfield",group:"textfield"},hiddenfield:{label:q.forms.hidden.title,command:"hiddenfield",group:"hiddenfield"},button:{label:q.forms.button.title,command:"button",group:"button"},select:{label:q.forms.select.title,command:"select",group:"select"},textarea:{label:q.forms.textarea.title,command:"textarea",group:"textarea"}},i&&(p.imagebutton={label:q.image.titleButton,command:"imagebutton",group:"imagebutton"}),!r.blockless&&(p.form={label:q.forms.form.menu,command:"form",group:"form"}),r.addMenuItems(p));r.contextMenu&&(!r.blockless&&r.contextMenu.addListener(function(e,f,b){if((e=b.contains("form",1))&&!e.isReadOnly()){return{form:CKEDITOR.TRISTATE_OFF}}}),r.contextMenu.addListener(function(e){if(e&&!e.isReadOnly()){var f=e.getName();if("select"==f){return{select:CKEDITOR.TRISTATE_OFF}}if("textarea"==f){return{textarea:CKEDITOR.TRISTATE_OFF}}if("input"==f){var b=e.getAttribute("type")||"text";switch(b){case"button":case"submit":case"reset":return{button:CKEDITOR.TRISTATE_OFF};case"checkbox":return{checkbox:CKEDITOR.TRISTATE_OFF};case"radio":return{radio:CKEDITOR.TRISTATE_OFF};case"image":return i?{imagebutton:CKEDITOR.TRISTATE_OFF}:null}if(j[b]){return{textfield:CKEDITOR.TRISTATE_OFF}}}if("img"==f&&"hiddenfield"==e.data("cke-real-element-type")){return{hiddenfield:CKEDITOR.TRISTATE_OFF}}}}));r.on("doubleclick",function(a){var b=a.data.element;if(!r.blockless&&b.is("form")){a.data.dialog="form"}else{if(b.is("select")){a.data.dialog="select"}else{if(b.is("textarea")){a.data.dialog="textarea"}else{if(b.is("img")&&"hiddenfield"==b.data("cke-real-element-type")){a.data.dialog="hiddenfield"}else{if(b.is("input")){b=b.getAttribute("type")||"text";switch(b){case"button":case"submit":case"reset":a.data.dialog="button";break;case"checkbox":a.data.dialog="checkbox";break;case"radio":a.data.dialog="radio";break;case"image":a.data.dialog="imagebutton"}j[b]&&(a.data.dialog="textfield")}}}}}})},afterInit:function(d){var c=d.dataProcessor,e=c&&c.htmlFilter,c=c&&c.dataFilter;CKEDITOR.env.ie&&e&&e.addRules({elements:{input:function(g){g=g.attributes;var f=g.type;f||(g.type="text");"checkbox"!=f&&"radio"!=f||"on"!=g.value||delete g.value}}},{applyToAll:!0});c&&c.addRules({elements:{input:function(a){if("hidden"==a.attributes.type){return d.createFakeParserElement(a,"cke_hidden","hiddenfield")}}}},{applyToAll:!0})}});