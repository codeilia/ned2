(function(){function d(f,m,i){if(!f.getCustomData("indent_processed")){var k=this.editor,h=this.isIndent;if(m){k=f.$.className.match(this.classNameRegex);i=0;k&&(k=k[1],i=CKEDITOR.tools.indexOf(m,k)+1);if(0>(i+=h?1:-1)){return}i=Math.min(i,m.length);i=Math.max(i,0);f.$.className=CKEDITOR.tools.ltrim(f.$.className.replace(this.classNameRegex,""));0<i&&f.addClass(m[i-1])}else{m=a(f,i);i=parseInt(f.getStyle(m),10);var j=k.config.indentOffset||40;isNaN(i)&&(i=0);i+=(h?1:-1)*j;if(0>i){return}i=Math.max(i,0);i=Math.ceil(i/j)*j;f.setStyle(m,i?i+(k.config.indentUnit||"px"):"");""===f.getAttribute("style")&&f.removeAttribute("style")}CKEDITOR.dom.element.setMarker(this.database,f,"indent_processed",1)}}function a(f,h){return"ltr"==(h||f.getComputedStyle("direction"))?"margin-left":"margin-right"}var c=CKEDITOR.dtd.$listItem,e=CKEDITOR.dtd.$list,b=CKEDITOR.TRISTATE_DISABLED,g=CKEDITOR.TRISTATE_OFF;CKEDITOR.plugins.add("indentblock",{requires:"indent",init:function(f){function j(){h.specificDefinition.apply(this,arguments);this.allowedContent={"div h1 h2 h3 h4 h5 h6 ol p pre ul":{propertiesOnly:!0,styles:i?null:"margin-left,margin-right",classes:i||null}};this.enterBr&&(this.allowedContent.div=!0);this.requiredContent=(this.enterBr?"div":"p")+(i?"("+i.join(",")+")":"{margin-left}");this.jobs={20:{refresh:function(l,k){var n=k.block||k.blockLimit;if(!n.is(c)){var o=n.getAscendant(c),n=o&&k.contains(o)||n}n.is(c)&&(n=n.getParent());if(this.enterBr||this.getContext(k)){if(i){var o=i,n=n.$.className.match(this.classNameRegex),m=this.isIndent,o=n?m?n[1]!=o.slice(-1):!0:m;return o?g:b}return this.isIndent?g:n?CKEDITOR[0>=(parseInt(n.getStyle(a(n)),10)||0)?"TRISTATE_DISABLED":"TRISTATE_OFF"]:b}return b},exec:function(l){var k=l.getSelection(),k=k&&k.getRanges()[0],m;if(m=l.elementPath().contains(e)){d.call(this,m,i)}else{for(k=k.createIterator(),l=l.config.enterMode,k.enforceRealBlocks=!0,k.enlargeBr=l!=CKEDITOR.ENTER_BR;m=k.getNextParagraph(l==CKEDITOR.ENTER_P?"p":"div");){m.isReadOnly()||d.call(this,m,i)}}return !0}}}}var h=CKEDITOR.plugins.indent,i=f.config.indentClasses;h.registerCommands(f,{indentblock:new j(f,"indentblock",!0),outdentblock:new j(f,"outdentblock")});CKEDITOR.tools.extend(j.prototype,h.specificDefinition.prototype,{context:{div:1,dl:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,ul:1,ol:1,p:1,pre:1,table:1},classNameRegex:i?new RegExp("(?:^|\\s+)("+i.join("|")+")(?\x3d$|\\s)"):null})}})})();