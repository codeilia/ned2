/*! lightgallery - v1.2.21 - 2016-06-28
* http://sachinchoolur.github.io/lightGallery/
* Copyright (c) 2016 Sachin N; Licensed Apache 2.0 */
(function(k,l,h,i){var j={scale:1,zoom:true,actualSize:true,enableZoomAfter:300};var g=function(a){this.core=k(a).data("lightGallery");this.core.s=k.extend({},j,this.core.s);if(this.core.s.zoom&&this.core.doCss()){this.init();this.zoomabletimeout=false;this.pageX=k(l).width()/2;this.pageY=(k(l).height()/2)+k(l).scrollTop()}return this};g.prototype.init=function(){var a=this;var f='<span id="lg-zoom-in" class="lg-icon"></span><span id="lg-zoom-out" class="lg-icon"></span>';if(a.core.s.actualSize){f+='<span id="lg-actual-size" class="lg-icon"></span>'}this.core.$outer.find(".lg-toolbar").append(f);a.core.$el.on("onSlideItemLoad.lg.tm.zoom",function(m,r,s){var t=a.core.s.enableZoomAfter+s;if(k("body").hasClass("lg-from-hash")&&s){t=0}else{k("body").removeClass("lg-from-hash")}a.zoomabletimeout=setTimeout(function(){a.core.$slide.eq(r).addClass("lg-zoomable")},t+30)});var b=1;var c=function(w){var x=a.core.$outer.find(".lg-current .lg-image");var y;var z;var A=(k(l).width()-x.width())/2;var m=((k(l).height()-x.height())/2)+k(l).scrollTop();y=a.pageX-A;z=a.pageY-m;var B=(w-1)*(y);var v=(w-1)*(z);x.css("transform","scale3d("+w+", "+w+", 1)").attr("data-scale",w);x.parent().css({left:-B+"px",top:-v+"px"}).attr("data-x",B).attr("data-y",v)};var n=function(){if(b>1){a.core.$outer.addClass("lg-zoomed")}else{a.resetZoom()}if(b<1){b=1}c(b)};var d=function(m,v,x,u){var y=v.width();var z;if(a.core.s.dynamic){z=a.core.s.dynamicEl[x].width||v[0].naturalWidth||y}else{z=a.core.$items.eq(x).attr("data-width")||v[0].naturalWidth||y}var w;if(a.core.$outer.hasClass("lg-zoomed")){b=1}else{if(z>y){w=z/y;b=w||2}}if(u){a.pageX=k(l).width()/2;a.pageY=(k(l).height()/2)+k(l).scrollTop()}else{a.pageX=m.pageX||m.originalEvent.targetTouches[0].pageX;a.pageY=m.pageY||m.originalEvent.targetTouches[0].pageY}n();setTimeout(function(){a.core.$outer.removeClass("lg-grabbing").addClass("lg-grab")},10)};var e=false;a.core.$el.on("onAferAppendSlide.lg.tm.zoom",function(m,r){var q=a.core.$slide.eq(r).find(".lg-image");q.on("dblclick",function(o){d(o,q,r)});q.on("touchstart",function(o){if(!e){e=setTimeout(function(){e=null},300)}else{clearTimeout(e);e=null;d(o,q,r)}o.preventDefault()})});k(l).on("resize.lg.zoom scroll.lg.zoom orientationchange.lg.zoom",function(){a.pageX=k(l).width()/2;a.pageY=(k(l).height()/2)+k(l).scrollTop();c(b)});k("#lg-zoom-out").on("click.lg",function(){if(a.core.$outer.find(".lg-current .lg-image").length){b-=a.core.s.scale;n()}});k("#lg-zoom-in").on("click.lg",function(){if(a.core.$outer.find(".lg-current .lg-image").length){b+=a.core.s.scale;n()}});k("#lg-actual-size").on("click.lg",function(m){d(m,a.core.$slide.eq(a.core.index).find(".lg-image"),a.core.index,true)});a.core.$el.on("onBeforeSlide.lg.tm",function(){b=1;a.resetZoom()});if(!a.core.isTouch){a.zoomDrag()}if(a.core.isTouch){a.zoomSwipe()}};g.prototype.resetZoom=function(){this.core.$outer.removeClass("lg-zoomed");this.core.$slide.find(".lg-img-wrap").removeAttr("style data-x data-y");this.core.$slide.find(".lg-image").removeAttr("style data-scale");this.pageX=k(l).width()/2;this.pageY=(k(l).height()/2)+k(l).scrollTop()};g.prototype.zoomSwipe=function(){var a=this;var c={};var e={};var d=false;var f=false;var b=false;a.core.$slide.on("touchstart.lg",function(p){if(a.core.$outer.hasClass("lg-zoomed")){var o=a.core.$slide.eq(a.core.index).find(".lg-object");b=o.outerHeight()*o.attr("data-scale")>a.core.$outer.find(".lg").height();f=o.outerWidth()*o.attr("data-scale")>a.core.$outer.find(".lg").width();if((f||b)){p.preventDefault();c={x:p.originalEvent.targetTouches[0].pageX,y:p.originalEvent.targetTouches[0].pageY}}}});a.core.$slide.on("touchmove.lg",function(r){if(a.core.$outer.hasClass("lg-zoomed")){var q=a.core.$slide.eq(a.core.index).find(".lg-img-wrap");var s;var t;r.preventDefault();d=true;e={x:r.originalEvent.targetTouches[0].pageX,y:r.originalEvent.targetTouches[0].pageY};a.core.$outer.addClass("lg-zoom-dragging");if(b){t=(-Math.abs(q.attr("data-y")))+(e.y-c.y)}else{t=-Math.abs(q.attr("data-y"))}if(f){s=(-Math.abs(q.attr("data-x")))+(e.x-c.x)}else{s=-Math.abs(q.attr("data-x"))}if((Math.abs(e.x-c.x)>15)||(Math.abs(e.y-c.y)>15)){q.css({left:s+"px",top:t+"px"})}}});a.core.$slide.on("touchend.lg",function(){if(a.core.$outer.hasClass("lg-zoomed")){if(d){d=false;a.core.$outer.removeClass("lg-zoom-dragging");a.touchendZoom(c,e,f,b)}}})};g.prototype.zoomDrag=function(){var a=this;var c={};var e={};var f=false;var d=false;var n=false;var b=false;a.core.$slide.on("mousedown.lg.zoom",function(m){var p=a.core.$slide.eq(a.core.index).find(".lg-object");b=p.outerHeight()*p.attr("data-scale")>a.core.$outer.find(".lg").height();n=p.outerWidth()*p.attr("data-scale")>a.core.$outer.find(".lg").width();if(a.core.$outer.hasClass("lg-zoomed")){if(k(m.target).hasClass("lg-object")&&(n||b)){m.preventDefault();c={x:m.pageX,y:m.pageY};f=true;a.core.$outer.scrollLeft+=1;a.core.$outer.scrollLeft-=1;a.core.$outer.removeClass("lg-grab").addClass("lg-grabbing")}}});k(l).on("mousemove.lg.zoom",function(m){if(f){var t=a.core.$slide.eq(a.core.index).find(".lg-img-wrap");var r;var s;d=true;e={x:m.pageX,y:m.pageY};a.core.$outer.addClass("lg-zoom-dragging");if(b){s=(-Math.abs(t.attr("data-y")))+(e.y-c.y)}else{s=-Math.abs(t.attr("data-y"))}if(n){r=(-Math.abs(t.attr("data-x")))+(e.x-c.x)}else{r=-Math.abs(t.attr("data-x"))}t.css({left:r+"px",top:s+"px"})}});k(l).on("mouseup.lg.zoom",function(m){if(f){f=false;a.core.$outer.removeClass("lg-zoom-dragging");if(d&&((c.x!==e.x)||(c.y!==e.y))){e={x:m.pageX,y:m.pageY};a.touchendZoom(c,e,n,b)}d=false}a.core.$outer.removeClass("lg-grabbing").addClass("lg-grab")})};g.prototype.touchendZoom=function(b,v,u,w){var c=this;var t=c.core.$slide.eq(c.core.index).find(".lg-img-wrap");var e=c.core.$slide.eq(c.core.index).find(".lg-object");var z=(-Math.abs(t.attr("data-x")))+(v.x-b.x);var a=(-Math.abs(t.attr("data-y")))+(v.y-b.y);var f=(c.core.$outer.find(".lg").height()-e.outerHeight())/2;var y=Math.abs((e.outerHeight()*Math.abs(e.attr("data-scale")))-c.core.$outer.find(".lg").height()+f);var d=(c.core.$outer.find(".lg").width()-e.outerWidth())/2;var x=Math.abs((e.outerWidth()*Math.abs(e.attr("data-scale")))-c.core.$outer.find(".lg").width()+d);if((Math.abs(v.x-b.x)>15)||(Math.abs(v.y-b.y)>15)){if(w){if(a<=-y){a=-y}else{if(a>=-f){a=-f}}}if(u){if(z<=-x){z=-x}else{if(z>=-d){z=-d}}}if(w){t.attr("data-y",Math.abs(a))}else{a=-Math.abs(t.attr("data-y"))}if(u){t.attr("data-x",Math.abs(z))}else{z=-Math.abs(t.attr("data-x"))}t.css({left:z+"px",top:a+"px"})}};g.prototype.destroy=function(){var a=this;a.core.$el.off(".lg.zoom");k(l).off(".lg.zoom");a.core.$slide.off(".lg.zoom");a.core.$el.off(".lg.tm.zoom");a.resetZoom();clearTimeout(a.zoomabletimeout);a.zoomabletimeout=false};k.fn.lightGallery.modules.zoom=g})(jQuery,window,document);