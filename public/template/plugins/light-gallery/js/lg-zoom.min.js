/*! lightgallery - v1.2.21 - 2016-06-28
* http://sachinchoolur.github.io/lightGallery/
* Copyright (c) 2016 Sachin N; Licensed Apache 2.0 */
(function(d,c,a,f){var e={scale:1,zoom:true,actualSize:true,enableZoomAfter:300};var b=function(g){this.core=d(g).data("lightGallery");this.core.s=d.extend({},e,this.core.s);if(this.core.s.zoom&&this.core.doCss()){this.init();this.zoomabletimeout=false;this.pageX=d(c).width()/2;this.pageY=(d(c).height()/2)+d(c).scrollTop()}return this};b.prototype.init=function(){var m=this;var h='<span id="lg-zoom-in" class="lg-icon"></span><span id="lg-zoom-out" class="lg-icon"></span>';if(m.core.s.actualSize){h+='<span id="lg-actual-size" class="lg-icon"></span>'}this.core.$outer.find(".lg-toolbar").append(h);m.core.$el.on("onSlideItemLoad.lg.tm.zoom",function(q,p,o){var n=m.core.s.enableZoomAfter+o;if(d("body").hasClass("lg-from-hash")&&o){n=0}else{d("body").removeClass("lg-from-hash")}m.zoomabletimeout=setTimeout(function(){m.core.$slide.eq(p).addClass("lg-zoomable")},n+30)});var l=1;var k=function(s){var r=m.core.$outer.find(".lg-current .lg-image");var q;var p;var o=(d(c).width()-r.width())/2;var u=((d(c).height()-r.height())/2)+d(c).scrollTop();q=m.pageX-o;p=m.pageY-u;var n=(s-1)*(q);var t=(s-1)*(p);r.css("transform","scale3d("+s+", "+s+", 1)").attr("data-scale",s);r.parent().css({left:-n+"px",top:-t+"px"}).attr("data-x",n).attr("data-y",t)};var g=function(){if(l>1){m.core.$outer.addClass("lg-zoomed")}else{m.resetZoom()}if(l<1){l=1}k(l)};var j=function(t,r,p,s){var o=r.width();var n;if(m.core.s.dynamic){n=m.core.s.dynamicEl[p].width||r[0].naturalWidth||o}else{n=m.core.$items.eq(p).attr("data-width")||r[0].naturalWidth||o}var q;if(m.core.$outer.hasClass("lg-zoomed")){l=1}else{if(n>o){q=n/o;l=q||2}}if(s){m.pageX=d(c).width()/2;m.pageY=(d(c).height()/2)+d(c).scrollTop()}else{m.pageX=t.pageX||t.originalEvent.targetTouches[0].pageX;m.pageY=t.pageY||t.originalEvent.targetTouches[0].pageY}g();setTimeout(function(){m.core.$outer.removeClass("lg-grabbing").addClass("lg-grab")},10)};var i=false;m.core.$el.on("onAferAppendSlide.lg.tm.zoom",function(p,n){var o=m.core.$slide.eq(n).find(".lg-image");o.on("dblclick",function(q){j(q,o,n)});o.on("touchstart",function(q){if(!i){i=setTimeout(function(){i=null},300)}else{clearTimeout(i);i=null;j(q,o,n)}q.preventDefault()})});d(c).on("resize.lg.zoom scroll.lg.zoom orientationchange.lg.zoom",function(){m.pageX=d(c).width()/2;m.pageY=(d(c).height()/2)+d(c).scrollTop();k(l)});d("#lg-zoom-out").on("click.lg",function(){if(m.core.$outer.find(".lg-current .lg-image").length){l-=m.core.s.scale;g()}});d("#lg-zoom-in").on("click.lg",function(){if(m.core.$outer.find(".lg-current .lg-image").length){l+=m.core.s.scale;g()}});d("#lg-actual-size").on("click.lg",function(n){j(n,m.core.$slide.eq(m.core.index).find(".lg-image"),m.core.index,true)});m.core.$el.on("onBeforeSlide.lg.tm",function(){l=1;m.resetZoom()});if(!m.core.isTouch){m.zoomDrag()}if(m.core.isTouch){m.zoomSwipe()}};b.prototype.resetZoom=function(){this.core.$outer.removeClass("lg-zoomed");this.core.$slide.find(".lg-img-wrap").removeAttr("style data-x data-y");this.core.$slide.find(".lg-image").removeAttr("style data-scale");this.pageX=d(c).width()/2;this.pageY=(d(c).height()/2)+d(c).scrollTop()};b.prototype.zoomSwipe=function(){var l=this;var j={};var h={};var i=false;var g=false;var k=false;l.core.$slide.on("touchstart.lg",function(n){if(l.core.$outer.hasClass("lg-zoomed")){var m=l.core.$slide.eq(l.core.index).find(".lg-object");k=m.outerHeight()*m.attr("data-scale")>l.core.$outer.find(".lg").height();g=m.outerWidth()*m.attr("data-scale")>l.core.$outer.find(".lg").width();if((g||k)){n.preventDefault();j={x:n.originalEvent.targetTouches[0].pageX,y:n.originalEvent.targetTouches[0].pageY}}}});l.core.$slide.on("touchmove.lg",function(p){if(l.core.$outer.hasClass("lg-zoomed")){var m=l.core.$slide.eq(l.core.index).find(".lg-img-wrap");var o;var n;p.preventDefault();i=true;h={x:p.originalEvent.targetTouches[0].pageX,y:p.originalEvent.targetTouches[0].pageY};l.core.$outer.addClass("lg-zoom-dragging");if(k){n=(-Math.abs(m.attr("data-y")))+(h.y-j.y)}else{n=-Math.abs(m.attr("data-y"))}if(g){o=(-Math.abs(m.attr("data-x")))+(h.x-j.x)}else{o=-Math.abs(m.attr("data-x"))}if((Math.abs(h.x-j.x)>15)||(Math.abs(h.y-j.y)>15)){m.css({left:o+"px",top:n+"px"})}}});l.core.$slide.on("touchend.lg",function(){if(l.core.$outer.hasClass("lg-zoomed")){if(i){i=false;l.core.$outer.removeClass("lg-zoom-dragging");l.touchendZoom(j,h,g,k)}}})};b.prototype.zoomDrag=function(){var m=this;var k={};var i={};var h=false;var j=false;var g=false;var l=false;m.core.$slide.on("mousedown.lg.zoom",function(o){var n=m.core.$slide.eq(m.core.index).find(".lg-object");l=n.outerHeight()*n.attr("data-scale")>m.core.$outer.find(".lg").height();g=n.outerWidth()*n.attr("data-scale")>m.core.$outer.find(".lg").width();if(m.core.$outer.hasClass("lg-zoomed")){if(d(o.target).hasClass("lg-object")&&(g||l)){o.preventDefault();k={x:o.pageX,y:o.pageY};h=true;m.core.$outer.scrollLeft+=1;m.core.$outer.scrollLeft-=1;m.core.$outer.removeClass("lg-grab").addClass("lg-grabbing")}}});d(c).on("mousemove.lg.zoom",function(q){if(h){var n=m.core.$slide.eq(m.core.index).find(".lg-img-wrap");var p;var o;j=true;i={x:q.pageX,y:q.pageY};m.core.$outer.addClass("lg-zoom-dragging");if(l){o=(-Math.abs(n.attr("data-y")))+(i.y-k.y)}else{o=-Math.abs(n.attr("data-y"))}if(g){p=(-Math.abs(n.attr("data-x")))+(i.x-k.x)}else{p=-Math.abs(n.attr("data-x"))}n.css({left:p+"px",top:o+"px"})}});d(c).on("mouseup.lg.zoom",function(n){if(h){h=false;m.core.$outer.removeClass("lg-zoom-dragging");if(j&&((k.x!==i.x)||(k.y!==i.y))){i={x:n.pageX,y:n.pageY};m.touchendZoom(k,i,g,l)}j=false}m.core.$outer.removeClass("lg-grabbing").addClass("lg-grab")})};b.prototype.touchendZoom=function(q,j,k,i){var p=this;var l=p.core.$slide.eq(p.core.index).find(".lg-img-wrap");var n=p.core.$slide.eq(p.core.index).find(".lg-object");var s=(-Math.abs(l.attr("data-x")))+(j.x-q.x);var r=(-Math.abs(l.attr("data-y")))+(j.y-q.y);var m=(p.core.$outer.find(".lg").height()-n.outerHeight())/2;var g=Math.abs((n.outerHeight()*Math.abs(n.attr("data-scale")))-p.core.$outer.find(".lg").height()+m);var o=(p.core.$outer.find(".lg").width()-n.outerWidth())/2;var h=Math.abs((n.outerWidth()*Math.abs(n.attr("data-scale")))-p.core.$outer.find(".lg").width()+o);if((Math.abs(j.x-q.x)>15)||(Math.abs(j.y-q.y)>15)){if(i){if(r<=-g){r=-g}else{if(r>=-m){r=-m}}}if(k){if(s<=-h){s=-h}else{if(s>=-o){s=-o}}}if(i){l.attr("data-y",Math.abs(r))}else{r=-Math.abs(l.attr("data-y"))}if(k){l.attr("data-x",Math.abs(s))}else{s=-Math.abs(l.attr("data-x"))}l.css({left:s+"px",top:r+"px"})}};b.prototype.destroy=function(){var g=this;g.core.$el.off(".lg.zoom");d(c).off(".lg.zoom");g.core.$slide.off(".lg.zoom");g.core.$el.off(".lg.tm.zoom");g.resetZoom();clearTimeout(g.zoomabletimeout);g.zoomabletimeout=false};d.fn.lightGallery.modules.zoom=b})(jQuery,window,document);